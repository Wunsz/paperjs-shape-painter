(this["webpackJsonppaperjs-shape-painter-example"]=this["webpackJsonppaperjs-shape-painter-example"]||[]).push([[0],{116:function(t,e,n){t.exports=n(297)},121:function(t,e,n){},122:function(t,e){},124:function(t,e){},126:function(t,e){},128:function(t,e){},297:function(t,e,n){"use strict";n.r(e);var i=n(0),o=n.n(i),a=n(24),s=n.n(a),c=(n(121),n(102)),r=n(103),p=n(112),u=n(110),l=n(104),d=(n(125),function(t,e){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)});function h(t,e){function n(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var m=function(){return(m=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},v="ELLIPSE",f="CIRCLE",g=function(t){this.onSettingsChanged=function(t){},this.settings=t},y=function(t){function e(e,n,i){var o=t.call(this,n)||this;return o.onMouseDown=function(t){},o.onMouseMove=function(t){},o.onMouseDrag=function(t){},o.onMouseUp=function(t){},o.onKeyUp=function(t){},o.scope=e,o.callback=function(t,e){return i()(t,e)},o}return h(e,t),e.prototype.updatePathData=function(t,e,n){void 0===n&&(n={}),t.style=m(m({},t.style),this.settings.settings.style),t.set(m({data:{type:e,ext:this.settings.settings.customData}},n))},e.prototype.activate=function(){this.tool=new this.scope.Tool,this.tool.onMouseDown=this.onMouseDown,this.tool.onMouseMove=this.onMouseMove,this.tool.onMouseDrag=this.onMouseDrag,this.tool.onMouseUp=this.onMouseUp,this.tool.onKeyUp=this.onKeyUp,this.tool.activate(),this.settings.addOnChangeListener(this.onSettingsChanged)},e.prototype.deactivate=function(){var t;null===(t=this.tool)||void 0===t||t.remove(),this.tool=void 0,this.settings.removeOnChangeListener(this.onSettingsChanged)},e.prototype.hitTest=function(t){return this.scope.project.hitTest(t,{segments:!0,stroke:!0,curves:!0,handles:!1,fill:!1,guide:!1,ends:!0,tolerance:this.settings.settings.snappingDistance/this.scope.view.zoom})},e}(g),E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onSettingsChanged=function(t){void 0!==e.path&&e.updatePathData(e.path,e.type)},e}return h(e,t),e}(y),C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="LINE",e.onMouseDown=function(t){void 0===e.path&&(e.path=new e.scope.Path,e.updatePathData(e.path,e.type,{selected:!0}),e.path.add(t.point),e.path.add(t.point))},e.onMouseDrag=function(t){void 0!==e.path&&(e.path.segments[1].point=t.point)},e.onMouseUp=function(t){void 0!==e.path&&(e.path.segments[1].point=t.point,e.updatePathData(e.path,e.type,{selected:!1}),e.callback(e.path.id,e.path),e.path=void 0)},e.onKeyUp=function(t){var n;"escape"===t.key&&(null===(n=e.path)||void 0===n||n.remove(),e.path=void 0,e.deactivate())},e}return h(e,t),e}(E),D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="RECTANGLE",e.onMouseDown=function(t){e.initialPoint=t.point,e.path=new e.scope.Path.Rectangle(t.point,t.point),e.path.selected=!0},e.onMouseDrag=function(t){void 0!==e.path&&(e.path.remove(),e.path=new e.scope.Path.Rectangle(e.initialPoint,t.point),e.path.selected=!0)},e.onMouseUp=function(t){void 0!==e.path&&(e.updatePathData(e.path,"RECTANGLE",{selected:!1}),e.callback(e.path.id,e.path),e.path=void 0)},e.onKeyUp=function(t){var n;"escape"===t.key&&(null===(n=e.path)||void 0===n||n.remove(),e.path=void 0,e.deactivate())},e}return h(e,t),e}(E),M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=v,e.onMouseDown=function(t){e.initialPoint=t.point,e.path=new e.scope.Path.Ellipse(new e.scope.Rectangle(t.point,t.point)),e.updatePathData(e.path,v,{selected:!0})},e.onMouseDrag=function(t){void 0!==e.path&&(e.path.remove(),e.path=new e.scope.Path.Ellipse(new e.scope.Rectangle(e.initialPoint,t.point)),e.updatePathData(e.path,v,{selected:!0}))},e.onMouseUp=function(t){void 0!==e.path&&(e.updatePathData(e.path,v,{selected:!1}),e.callback(e.path.id,e.path),e.path=void 0)},e.onKeyUp=function(t){var n;"escape"===t.key&&(null===(n=e.path)||void 0===n||n.remove(),e.path=void 0,e.deactivate())},e}return h(e,t),e}(E),b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=f,e.onMouseDown=function(t){e.initialPoint=t.point,e.path=new e.scope.Path.Circle(t.point,0),e.updatePathData(e.path,f,{selected:!0})},e.onMouseDrag=function(t){void 0!==e.path&&(e.path.remove(),e.path=new e.scope.Path.Circle(e.initialPoint,t.point.getDistance(e.initialPoint)),e.updatePathData(e.path,f,{selected:!0}))},e.onMouseUp=function(t){void 0!==e.path&&(e.updatePathData(e.path,f,{selected:!1}),e.callback(e.path.id,e.path),e.path=void 0)},e.onKeyUp=function(t){var n;"escape"===t.key&&(null===(n=e.path)||void 0===n||n.remove(),e.path=void 0,e.deactivate())},e}return h(e,t),e}(E),w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="POLYGON",e.closed=!1,e.onMouseDrag=function(t){void 0!==e.path&&(e.shouldSnap(t.point)?(e.path.lastSegment.point=e.path.firstSegment.point,e.closed=!0):(e.closed=!1,e.path.lastSegment.point=t.point))},e.onMouseUp=function(t){void 0!==e.path&&(e.closed?(e.path.removeSegment(e.path.segments.length-1),e.path.closed=!0,e.updatePathData(e.path,"POLYGON",{selected:!1}),e.callback(e.path.id,e.path),e.path=void 0):e.path.add(t.point))},e}return h(e,t),e.prototype.shouldSnap=function(t){return void 0!==this.path&&this.path.segments.length>2&&this.path.firstSegment.point.getDistance(t,!0)<20*this.settings.settings.snappingDistance/this.scope.view.zoom},e}(C),k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onSettingsChanged=function(t){void 0!==e.item&&(e.item.style=m(m({},e.item.style),e.settings.settings.style))},e.onMouseDown=function(t){},e.onMouseMove=function(t){},e.onMouseDrag=function(t){},e.onMouseUp=function(t){},e.onKeyUp=function(t){},e}return h(e,t),e.prototype.enable=function(t,e){this.item=t,this.scope=e,this.settings.addOnChangeListener(this.onSettingsChanged)},e.prototype.disable=function(){void 0!==this.item&&(this.item.selected=!1),this.settings.removeOnChangeListener(this.onSettingsChanged)},e.prototype.getMeta=function(){return this.item.data},e.prototype.beginEdit=function(t,e){var n=this.hitTest(t.point);null!==n&&n.item===this.item&&"segment"===n.type&&(this.segment=n.segment,this.segment.selected=e)},e.prototype.endEdit=function(t){void 0!==this.item&&void 0!==this.segment&&(this.segment.selected=!1,this.segment=void 0)},e.prototype.hitTest=function(t){return this.scope.project.hitTest(t,{segments:!0,stroke:!0,curves:!0,handles:!1,fill:!1,guide:!1,ends:!0,tolerance:this.settings.settings.snappingDistance/this.scope.view.zoom})},e}(g),P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onMouseDown=function(t){e.beginEdit(t,!0)},e.onMouseDrag=function(t){void 0!==e.segment?(e.segment.point.x+=t.delta.x,e.segment.point.y+=t.delta.y):void 0!==e.item&&(e.item.position.x+=t.delta.x,e.item.position.y+=t.delta.y)},e.onMouseUp=function(t){e.endEdit(t)},e}return h(e,t),e}(k),x=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onMouseDown=function(t){e.beginEdit(t,!0)},e.onMouseDrag=function(t){void 0!==e.segment?(e.segment.previous.point.x==e.segment.point.x?(e.segment.previous.point.x+=t.delta.x,e.segment.next.point.y+=t.delta.y):(e.segment.previous.point.y+=t.delta.y,e.segment.next.point.x+=t.delta.x),e.segment.point.x+=t.delta.x,e.segment.point.y+=t.delta.y):void 0!==e.item&&(e.item.position.x+=t.delta.x,e.item.position.y+=t.delta.y)},e.onMouseUp=function(t){e.endEdit(t)},e}return h(e,t),e}(k),T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onMouseDown=function(t){e.beginEdit(t,!1)},e.onMouseDrag=function(t){if(void 0!==e.segment){var n=e.getCenter(),i=e.segment.point.getDistance(n),o=t.point.getDistance(n);e.item.scale(o/i)}else void 0!==e.item&&(e.item.position.x+=t.delta.x,e.item.position.y+=t.delta.y)},e.onMouseUp=function(t){e.endEdit(t)},e}return h(e,t),e.prototype.getCenter=function(){var t=this.item;return new this.scope.Point(t.firstSegment.next.point.x,t.firstSegment.point.y)},e}(k),O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onMouseDown=function(t){e.beginEdit(t,!1)},e.onMouseDrag=function(t){if(void 0!==e.segment){var n=e.getCenter(),i=e.segment.point.getDistance(n),o=t.point.getDistance(n),a=e.item;e.segment===a.firstSegment.previous||e.segment===a.firstSegment.next?e.item.scale(1,o/i):e.item.scale(o/i,1)}else void 0!==e.item&&(e.item.position.x+=t.delta.x,e.item.position.y+=t.delta.y)},e.onMouseUp=function(t){e.endEdit(t)},e}return h(e,t),e.prototype.getCenter=function(){var t=this.item;return new this.scope.Point(t.firstSegment.next.point.x,t.firstSegment.point.y)},e}(k),S=function(t){function e(e,n,i){var o=t.call(this,e,n,i)||this;return o.type="EDIT",o.onMouseDown=function(t){void 0!==o.lastEventTimestamp&&t.timeStamp-o.lastEventTimestamp<250?(o.checkAndActOnItem(t.point,!0),o.lastEventTimestamp=void 0):o.lastEventTimestamp=t.timeStamp,void 0!==o.editor&&o.editor.onMouseDown(t)},o.onMouseUp=function(t){void 0!==o.editor&&o.editor.onMouseUp(t)},o.onMouseMove=function(t){void 0!==o.editor?o.editor.onMouseMove(t):o.checkAndActOnItem(t.point)},o.onMouseDrag=function(t){void 0!==o.editor&&o.editor.onMouseDrag(t)},o.onKeyUp=function(t){var e;"escape"===t.key&&(null===(e=o.item)||void 0===e?void 0:e.selected)&&(o.item.selected=!1,o.item=void 0)},o.setItem=function(t){void 0!==o.item&&(o.item.selected=!1,void 0!==o.editor&&o.callback(o.item.id,o.item),o.disableEditor()),o.item=t,o.enableEditor()},o}return h(e,t),e.prototype.checkAndActOnItem=function(t,e){void 0===e&&(e=!1);var n=this.hitTest(t);null!==n&&void 0===this.editor?(void 0!==this.item&&(this.item.selected=!1),this.item=n.item,this.item.selected=!0,e&&this.enableEditor()):void 0!==this.item&&(this.item.selected=!1,void 0!==this.editor&&this.callback(this.item.id,this.item),this.disableEditor())},e.prototype.deactivate=function(){this.disableEditor(),t.prototype.deactivate.call(this)},e.prototype.enableEditor=function(){var t;if(void 0!==this.item&&void 0!==this.item.data.type){switch(this.item.data.type){case"LINE":case"POLYGON":this.editor=new P(this.settings);break;case"RECTANGLE":this.editor=new x(this.settings);break;case f:this.editor=new T(this.settings);break;case v:this.editor=new O(this.settings)}this.item.selected=!0,null===(t=this.editor)||void 0===t||t.enable(this.item,this.scope)}},e.prototype.disableEditor=function(){void 0!==this.editor&&(this.editor.disable(),this.editor=void 0,this.item=void 0)},e}(y),I=function(t){function e(e,n,i){var o=t.call(this,e,n,i)||this;return o.type="REMOVE",o.onMouseMove=function(t){var e=o.hitTest(t.point);void 0===o.item||null!==e&&e.item===o.item||(o.item.selected=!1,o.item=void 0),null!==e&&(o.item=e.item,o.item.selected=!0)},o.onMouseUp=function(t){void 0!==o.item&&(o.callback(o.item.id,o.item),o.item.remove())},o}return h(e,t),e}(y),L=function(){var t=this;this.settings=m({},U),this.listeners=new Set,this.update=function(e,n){var i;void 0===n&&(n=!1);var o=null!==(i=e.style)&&void 0!==i?i:t.settings.style;t.settings=m(m(m({},t.settings),e),{style:n?m(m({},t.settings.style),o):o}),t.listeners.forEach((function(e){return e(t.settings)}))},this.reset=function(){t.settings=m({},U)},this.addOnChangeListener=function(e){return t.listeners.add(e),e},this.removeOnChangeListener=function(e){t.listeners.delete(e)}},U={style:{},snappingDistance:10,customData:void 0},R=function(){function t(t){var e,n=this;this.settings=new L,this.onAddedCallback=function(t,e){return null},this.onChangedCallback=function(t,e){return null},this.onRemovedCallback=function(t,e){return null},this.editItem=function(t){n.selectTool("EDIT"),n.activeTool.setItem(t)},this.scope=t,this.tools=((e={}).LINE=new C(this.scope,this.settings,(function(){return n.onAddedCallback})),e.RECTANGLE=new D(this.scope,this.settings,(function(){return n.onAddedCallback})),e[v]=new M(this.scope,this.settings,(function(){return n.onAddedCallback})),e[f]=new b(this.scope,this.settings,(function(){return n.onAddedCallback})),e.POLYGON=new w(this.scope,this.settings,(function(){return n.onAddedCallback})),e.EDIT=new S(this.scope,this.settings,(function(){return n.onChangedCallback})),e.REMOVE=new I(this.scope,this.settings,(function(){return n.onRemovedCallback})),e)}return t.prototype.getActiveTool=function(){return this.activeTool},t.prototype.getItemById=function(t){return this.scope.project.getItem({id:t})},t.prototype.getItemByCustomData=function(t){return this.scope.project.getItem((function(e){return void 0!==e.data&&void 0!==e.data.ext&&e.data.ext.customData===t}))},t.prototype.getItemByCustomDataPartialMatch=function(t){return this.scope.project.getItem((function(e){return void 0!==e.data&&void 0!==e.data.ext&&"object"===typeof e.data.ext&&Object.getOwnPropertyNames(t).some((function(n){return t[n]===e.data.ext[n]}))}))},t.prototype.selectTool=function(t){this.activeTool=this.tools[t],this.activeTool.activate()},t.prototype.cancelCurrentPainting=function(){void 0!==this.activeTool&&(this.activeTool.deactivate(),this.activeTool=void 0)},t}(),A=n(111),j=n(105),N=function(t){var e=t.onColorChange,n=void 0===e?function(t){return null}:e,a=Object(i.useState)("#000"),s=Object(A.a)(a,2),c=s[0],r=s[1];return o.a.createElement("div",{id:"pickerContainer"},o.a.createElement(j.SketchPicker,{color:c,onChange:function(t){r(t.hex),n(t.hex)}}))},G=n(310),K=n(313),_=n(312),B=n(314),V=function(t){Object(p.a)(n,t);var e=Object(u.a)(n);function n(t){var i;return Object(c.a)(this,n),(i=e.call(this,t)).editRandom=function(){var t=i.scope.view.size,e=t.width,n=t.height,o=i.scope.project.getItems({inside:new i.scope.Rectangle(0,0,e,n),match:function(t){return void 0!==t.data&&void 0!==t.data.type}});o.length>0?i.painter.editItem(o[0]):console.warn("No items found!")},i.ref=o.a.createRef(),i}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var t=new l.PaperScope;t.setup(this.ref.current),this.scope=t,this.painter=new R(t),this.painter.settings.update({style:{strokeColor:"#000",strokeWidth:1}}),this.painter.onAddedCallback=function(t,e){return console.debug("Added element: ".concat(t),e.data)},this.painter.onChangedCallback=function(t,e){return console.debug("Changed element: ".concat(t),e.data)},this.painter.onRemovedCallback=function(t,e){return console.debug("Removed element: ".concat(t),e.data)}}},{key:"render",value:function(){var t=this;return o.a.createElement("div",{id:"appContainer"},o.a.createElement(G.a,{id:"canvasContainer"},o.a.createElement("canvas",{ref:this.ref,id:"canvas",width:1200,height:800})),o.a.createElement("div",{id:"actions"},o.a.createElement(G.a,{id:"actionButtons"},o.a.createElement(K.a,{onClick:function(){return t.painter.cancelCurrentPainting()}},"Cancel"),o.a.createElement(K.a,{onClick:function(){return t.painter.selectTool("LINE")}},"Draw line"),o.a.createElement(K.a,{onClick:function(){return t.painter.selectTool("RECTANGLE")}},"Draw rect"),o.a.createElement(K.a,{onClick:function(){return t.painter.selectTool("ELLIPSE")}},"Draw ellipse"),o.a.createElement(K.a,{onClick:function(){return t.painter.selectTool("CIRCLE")}},"Draw circle"),o.a.createElement(K.a,{onClick:function(){return t.painter.selectTool("POLYGON")}},"Draw polygon"),o.a.createElement(K.a,{onClick:this.editRandom},"Edit random"),o.a.createElement(K.a,{onClick:function(){return t.painter.selectTool("EDIT")}},"Edit"),o.a.createElement(K.a,{onClick:function(){return t.painter.selectTool("REMOVE")}},"Remove")),o.a.createElement(N,{onColorChange:function(e){t.painter.settings.update({style:{strokeColor:e}},!0)}}),o.a.createElement(G.a,{className:"slider"},o.a.createElement(_.a,{variant:"subtitle1"},"Slide width"),o.a.createElement(B.a,{defaultValue:1,min:1,max:50,step:1,valueLabelDisplay:"auto",onChange:function(e,n){t.painter.settings.update({style:{strokeWidth:n}},!0)}})),o.a.createElement(G.a,{className:"slider"},o.a.createElement(_.a,{variant:"subtitle1"},"Snapping distance"),o.a.createElement(B.a,{defaultValue:10,min:1,max:1e3,step:1,valueLabelDisplay:"auto",onChange:function(e,n){t.painter.settings.update({snappingDistance:n})}}))))}}]),n}(i.Component);s.a.render(o.a.createElement(V,null),document.getElementById("root"))}},[[116,1,2]]]);
//# sourceMappingURL=main.5d74abcc.chunk.js.map